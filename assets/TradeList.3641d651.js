import{_ as F,o as n,c as _,a as C,t as V,g as v,m as O,d as H,r as k,j as x,w as d,b as s,f as T,a1 as le,D as oe,u as N,h as p,i as U,k as ie,l as D,x as I,q as re,H as ne,J as w}from"./index.a985966a.js";import{T as se,D as M}from"./TradeProfit.acb15129.js";const de={name:"CloseBoxMultipleIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ue=["aria-hidden","aria-label"],ce=["fill","width","height"],me={d:"M4 20H18V22H4C2.9 22 2 21.11 2 20V6H4V20M20.22 2H7.78C6.8 2 6 2.8 6 3.78V16.22C6 17.2 6.8 18 7.78 18H20.22C21.2 18 22 17.2 22 16.22V3.78C22 2.8 21.2 2 20.22 2M19 13.6L17.6 15L14 11.4L10.4 15L9 13.6L12.6 10L9 6.4L10.4 5L14 8.6L17.6 5L19 6.4L15.4 10L19 13.6Z"},fe={key:0};function pe(e,l,t,u,c,b){return n(),_("span",O(e.$attrs,{"aria-hidden":!t.title,"aria-label":t.title,class:"material-design-icon close-box-multiple-icon",role:"img",onClick:l[0]||(l[0]=r=>e.$emit("click",r))}),[(n(),_("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[C("path",me,[t.title?(n(),_("title",fe,V(t.title),1)):v("",!0)])],8,ce))],16,ue)}var ve=F(de,[["render",pe]]);const be={name:"GestureTapIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},ye=["aria-hidden","aria-label"],_e=["fill","width","height"],ge={d:"M10,9A1,1 0 0,1 11,8A1,1 0 0,1 12,9V13.47L13.21,13.6L18.15,15.79C18.68,16.03 19,16.56 19,17.14V21.5C18.97,22.32 18.32,22.97 17.5,23H11C10.62,23 10.26,22.85 10,22.57L5.1,18.37L5.84,17.6C6.03,17.39 6.3,17.28 6.58,17.28H6.8L10,19V9M11,5A4,4 0 0,1 15,9C15,10.5 14.2,11.77 13,12.46V11.24C13.61,10.69 14,9.89 14,9A3,3 0 0,0 11,6A3,3 0 0,0 8,9C8,9.89 8.39,10.69 9,11.24V12.46C7.8,11.77 7,10.5 7,9A4,4 0 0,1 11,5Z"},ke={key:0};function Ve(e,l,t,u,c,b){return n(),_("span",O(e.$attrs,{"aria-hidden":!t.title,"aria-label":t.title,class:"material-design-icon gesture-tap-icon",role:"img",onClick:l[0]||(l[0]=r=>e.$emit("click",r))}),[(n(),_("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[C("path",ge,[t.title?(n(),_("title",ke,V(t.title),1)):v("",!0)])],8,_e))],16,ye)}var xe=F(be,[["render",Ve]]);const Ce={name:"CloseBoxIcon",emits:["click"],props:{title:{type:String},fillColor:{type:String,default:"currentColor"},size:{type:Number,default:24}}},$e=["aria-hidden","aria-label"],he=["fill","width","height"],Te={d:"M19,3H16.3H7.7H5A2,2 0 0,0 3,5V7.7V16.4V19A2,2 0 0,0 5,21H7.7H16.4H19A2,2 0 0,0 21,19V16.3V7.7V5A2,2 0 0,0 19,3M15.6,17L12,13.4L8.4,17L7,15.6L10.6,12L7,8.4L8.4,7L12,10.6L15.6,7L17,8.4L13.4,12L17,15.6L15.6,17Z"},Se={key:0};function we(e,l,t,u,c,b){return n(),_("span",O(e.$attrs,{"aria-hidden":!t.title,"aria-label":t.title,class:"material-design-icon close-box-icon",role:"img",onClick:l[0]||(l[0]=r=>e.$emit("click",r))}),[(n(),_("svg",{fill:t.fillColor,class:"material-design-icon__svg",width:t.size,height:t.size,viewBox:"0 0 24 24"},[C("path",Te,[t.title?(n(),_("title",Se,V(t.title),1)):v("",!0)])],8,he))],16,$e)}var z=F(Ce,[["render",we]]);const Fe={class:"d-flex flex-column"},Le=H({__name:"TradeActions",props:{botApiVersion:{type:Number,default:1},trade:{type:Object,required:!0}},emits:["forceExit","forceExitPartial","cancelOpenOrder","deleteTrade"],setup(e){return(l,t)=>{const u=k("b-button");return n(),_("div",Fe,[e.botApiVersion<=1.1?(n(),x(u,{key:0,class:"btn-xs text-start",size:"sm",title:"Forceexit",onClick:t[0]||(t[0]=c=>l.$emit("forceExit",e.trade))},{default:d(()=>[s(z,{size:16,title:"Forceexit",class:"me-1"}),T("Forceexit ")]),_:1})):v("",!0),e.botApiVersion>1.1?(n(),x(u,{key:1,class:"btn-xs text-start",size:"sm",title:"Forceexit limit",onClick:t[1]||(t[1]=c=>l.$emit("forceExit",e.trade,"limit"))},{default:d(()=>[s(z,{size:16,title:"Forceexit limit",class:"me-1"}),T("Forceexit limit ")]),_:1})):v("",!0),e.botApiVersion>1.1?(n(),x(u,{key:2,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit market",onClick:t[2]||(t[2]=c=>l.$emit("forceExit",e.trade,"market"))},{default:d(()=>[s(z,{size:16,title:"Forceexit market",class:"me-1"}),T("Forceexit market ")]),_:1})):v("",!0),e.botApiVersion>2.16?(n(),x(u,{key:3,class:"btn-xs text-start mt-1",size:"sm",title:"Forceexit partial",onClick:t[3]||(t[3]=c=>l.$emit("forceExitPartial",e.trade))},{default:d(()=>[s(ve,{size:16,title:"Forceexit partial",class:"me-1"}),T("Forceexit partial ")]),_:1})):v("",!0),e.botApiVersion>=2.24&&e.trade.open_order_id?(n(),x(u,{key:4,class:"btn-xs text-start mt-1",size:"sm",title:"Cancel open orders",onClick:t[4]||(t[4]=c=>l.$emit("cancelOpenOrder",e.trade))},{default:d(()=>[s(le,{size:16,title:"Cancel open order",class:"me-1"}),T("Cancel open order ")]),_:1})):v("",!0),s(u,{class:"btn-xs text-start mt-1",size:"sm",title:"Delete trade",onClick:t[5]||(t[5]=c=>l.$emit("deleteTrade",e.trade))},{default:d(()=>[s(oe,{size:16,title:"Delete trade",class:"me-1"}),T(" Delete ")]),_:1})])}}}),Be=H({name:"ForceExitForm",props:{trade:{type:Object,required:!0},modelValue:{required:!0,default:!1,type:Boolean}},emits:["update:modelValue"],setup(e,{emit:l}){const t=N(),u=p(),c=p(void 0),b=p("limit"),r=()=>{var y;return(y=u.value)==null?void 0:y.checkValidity()},$=U({get(){return e.modelValue},set(f){l("update:modelValue",f)}}),h=()=>{if(!r())return;const f={tradeid:String(e.trade.trade_id)};b.value&&(f.ordertype=b.value),c.value&&(f.amount=c.value),t.activeBot.forceexit(f),$.value=!1};return{handleSubmit:h,botStore:t,form:u,handleEntry:()=>{h()},resetForm:()=>{var f,y,L,B;c.value=e.trade.amount,t.activeBot.botApiVersion>1.1&&(b.value=((y=(f=t.activeBot.botState)==null?void 0:f.order_types)==null?void 0:y.force_exit)||((B=(L=t.activeBot.botState)==null?void 0:L.order_types)==null?void 0:B.exit)||"limit")},amount:c,ordertype:b,model:$}}}),Ae=C("br",null,null,-1);function Ee(e,l,t,u,c,b){const r=k("b-form-input"),$=k("b-form-group"),h=k("b-form-select"),S=k("b-modal");return n(),_("div",null,[s(S,{id:"forceexit-modal",modelValue:e.model,"onUpdate:modelValue":l[4]||(l[4]=m=>e.model=m),title:"Force exiting a trade",onShow:e.resetForm,onHidden:e.resetForm,onOk:e.handleEntry},{default:d(()=>[C("form",{ref:"form",onSubmit:l[3]||(l[3]=ie((...m)=>e.handleSubmit&&e.handleSubmit(...m),["stop","prevent"]))},[C("p",null,[C("span",null,"Exiting Trade #"+V(e.trade.trade_id)+" "+V(e.trade.pair)+".",1),Ae,C("span",null,"Currently owning "+V(e.trade.amount)+" "+V(e.trade.base_currency),1)]),e.botStore.activeBot.botApiVersion>1.12?(n(),x($,{key:0,label:`*Amount in ${e.trade.base_currency} [optional]`,"label-for":"stake-input","invalid-feedback":"Amount must be empty or a positive number",state:e.amount!==void 0&&e.amount>0},{default:d(()=>[s(r,{id:"stake-input",modelValue:e.amount,"onUpdate:modelValue":l[0]||(l[0]=m=>e.amount=m),type:"number",step:"0.000001",onKeydown:D(e.handleEntry,["enter","native"])},null,8,["modelValue","onKeydown"]),s(r,{id:"stake-input",modelValue:e.amount,"onUpdate:modelValue":l[1]||(l[1]=m=>e.amount=m),type:"range",step:"0.000001",min:"0",max:e.trade.amount,onKeydown:D(e.handleEntry,["enter","native"])},null,8,["modelValue","max","onKeydown"])]),_:1},8,["label","state"])):v("",!0),e.botStore.activeBot.botApiVersion>1.1?(n(),x($,{key:1,label:"*OrderType","label-for":"ordertype-input","invalid-feedback":"OrderType",state:e.ordertype!==void 0},{default:d(()=>[s(h,{modelValue:e.ordertype,"onUpdate:modelValue":l[2]||(l[2]=m=>e.ordertype=m),class:"ms-2",options:["market","limit"],style:{"min-width":"7em"},size:"sm"},null,8,["modelValue"])]),_:1},8,["state"])):v("",!0)],544)]),_:1},8,["modelValue","onShow","onHidden","onOk"])])}var Ie=F(Be,[["render",Ee]]);const ze={class:"h-100 overflow-auto w-100"},Oe={class:"w-100 d-flex justify-content-between"},He=H({__name:"TradeList",props:{trades:{required:!0,type:Array},title:{default:"Trades",type:String},stakeCurrency:{required:!1,default:"",type:String},activeTrades:{default:!1,type:Boolean},showFilter:{default:!1,type:Boolean},multiBotView:{default:!1,type:Boolean},emptyText:{default:"No Trades to show.",type:String}},setup(e){const l=e,t=N(),u=p(1),c=p(),b=p(""),r=p({}),$=l.activeTrades?200:15,h=p(),S=p(!1),m=p(!1),f=p(""),y=p(null),L=[{key:"actions"}],B=[{key:"close_timestamp",label:"Close date"},{key:"exit_reason",label:"Close Reason"}],P=a=>I(a,t.activeBot.stakeCurrencyDecimals),R=U(()=>l.trades.length),q=[l.multiBotView?{key:"botName",label:"Bot"}:{},{key:"trade_id",label:"ID"},{key:"pair",label:"Pair"},{key:"amount",label:"Amount"},{key:"stake_amount",label:"Stake amount",formatter:a=>P(a)},{key:"open_rate",label:"Open rate",formatter:a=>I(a)},{key:l.activeTrades?"current_rate":"close_rate",label:l.activeTrades?"Current rate":"Close rate",formatter:a=>I(a)},{key:"profit",label:l.activeTrades?"Current profit %":"Profit %",formatter:(a,i,g)=>`${re(g.profit_ratio,2)} ${`(${P(g.profit_abs)})`}`},{key:"open_timestamp",label:"Open date"},...l.activeTrades?L:B],A=p(void 0),K=(a,i=void 0)=>{r.value=a,y.value=1,f.value=`Really exit trade ${a.trade_id} (Pair ${a.pair}) using ${i} Order?`,m.value=!0,A.value=i},j=()=>{if(y.value===0){const a={tradeid:String(r.value.trade_id),botId:r.value.botId};t.deleteTradeMulti(a).catch(i=>console.log(i.response))}if(y.value===1){const a={tradeid:String(r.value.trade_id),botId:r.value.botId};A.value&&(a.ordertype=A.value),t.forceSellMulti(a).then(i=>console.log(i)).catch(i=>console.log(i.response))}if(y.value===3){const a={tradeid:String(r.value.trade_id),botId:r.value.botId};t.cancelOpenOrderMulti(a)}A.value=void 0,m.value=!1},Z=a=>{f.value=`Really delete trade ${a.trade_id} (Pair ${a.pair})?`,y.value=0,r.value=a,m.value=!0},G=a=>{r.value=a,S.value=!0},J=a=>{f.value=`Cancel open order for trade ${a.trade_id} (Pair ${a.pair})?`,r.value=a,y.value=3,m.value=!0},W=(a,i,g)=>{!l.activeTrades||(g.preventDefault(),console.log(a))},Q=a=>{a&&a.trade_id!==t.activeBot.detailTradeId?t.activeBot.setDetailTrade(a):t.activeBot.setDetailTrade(null)},X=()=>{var a;if(t.activeBot.detailTradeId){const i=l.trades.findIndex(g=>g.trade_id===t.activeBot.detailTradeId);i>=0?(a=h.value)==null||a.selectRow(i):(console.log(`Unsetting item for tradeid ${c.value}`),c.value=void 0)}};return ne(()=>t.activeBot.detailTradeId,a=>{var g;l.trades.findIndex(E=>E.trade_id===a)<0&&((g=h.value)==null||g.clearSelected())}),(a,i)=>{const g=k("b-button"),E=k("b-popover"),Y=k("b-table"),ee=k("b-pagination"),te=k("b-form-input"),ae=k("b-modal");return n(),_("div",ze,[s(Y,{ref_key:"tradesTable",ref:h,small:"",hover:"",stacked:"md",items:[...e.trades],fields:q,"show-empty":"","empty-text":e.emptyText,"per-page":w($),"current-page":u.value,"primary-key":"botTradeId",selectable:"","select-head":!1,"select-mode":"single",filter:b.value,onRowContextmenu:W,onRowClicked:Q,onRowSelected:X},{"cell(actions)":d(o=>[s(g,{id:`btn-actions_${o.index}`,class:"btn-xs",size:"sm",title:"Actions",href:"#"},{default:d(()=>[s(xe,{size:16,title:"Actions"})]),_:2},1032,["id"]),s(E,{target:`btn-actions_${o.index}`,title:`Actions for ${o.item.pair}`,triggers:"focus",placement:"left"},{default:d(()=>[s(Le,{trade:o.item,"bot-api-version":w(t).activeBot.botApiVersion,onDeleteTrade:Z,onForceExit:K,onForceExitPartial:G,onCancelOpenOrder:J},null,8,["trade","bot-api-version"])]),_:2},1032,["target","title"])]),"cell(pair)":d(o=>[C("span",null,V(`${o.item.pair}${o.item.open_order_id===void 0||o.item.open_order_id===null?"":"*"}`),1)]),"cell(trade_id)":d(o=>[T(V(o.item.trade_id)+" "+V(w(t).activeBot.botApiVersion>2&&o.item.trading_mode!=="spot"?"| "+(o.item.is_short?"Short":"Long"):""),1)]),"cell(profit)":d(o=>[s(se,{trade:o.item},null,8,["trade"])]),"cell(open_timestamp)":d(o=>[s(M,{date:o.item.open_timestamp},null,8,["date"])]),"cell(close_timestamp)":d(o=>[s(M,{date:o.item.close_timestamp},null,8,["date"])]),_:1},8,["items","empty-text","per-page","current-page","filter"]),C("div",Oe,[e.activeTrades?v("",!0):(n(),x(ee,{key:0,modelValue:u.value,"onUpdate:modelValue":i[0]||(i[0]=o=>u.value=o),"total-rows":w(R),"per-page":w($),"aria-controls":"my-table"},null,8,["modelValue","total-rows","per-page"])),e.showFilter?(n(),x(te,{key:1,modelValue:b.value,"onUpdate:modelValue":i[1]||(i[1]=o=>b.value=o),type:"text",placeholder:"Filter",size:"sm",style:{width:"unset"}},null,8,["modelValue"])):v("",!0)]),e.activeTrades?(n(),x(Ie,{key:0,modelValue:S.value,"onUpdate:modelValue":i[2]||(i[2]=o=>S.value=o),trade:r.value},null,8,["modelValue","trade"])):v("",!0),s(ae,{modelValue:m.value,"onUpdate:modelValue":i[3]||(i[3]=o=>m.value=o),title:"Exit trade",onOk:j},{default:d(()=>[T(V(f.value),1)]),_:1},8,["modelValue"])])}}});var Me=F(He,[["__scopeId","data-v-ec2e104c"]]);export{ve as F,Me as T};
//# sourceMappingURL=TradeList.3641d651.js.map
